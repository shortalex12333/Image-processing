# Image Processing Service - Environment Variables Template
# Copy to .env and fill in your values

# =============================================================================
# Supabase Configuration
# =============================================================================
NEXT_PUBLIC_SUPABASE_URL=https://your-project.supabase.co
SUPABASE_SERVICE_ROLE_KEY=your-service-role-key-here
SUPABASE_ANON_KEY=your-anon-key-here

# =============================================================================
# OpenAI Configuration
# =============================================================================
OPENAI_API_KEY=sk-your-openai-key-here
OPENAI_ORG_ID=org-your-org-id  # Optional

# =============================================================================
# OCR Configuration - Feature Flags (Toggle Based on Your Render Plan)
# =============================================================================
# See OCR_SCALING_GUIDE.md for complete configuration guide

# TIER 1: Starter Plan (512 MB RAM) - Enable cloud/lightweight engines only
ENABLE_GOOGLE_VISION=true      # 80% accuracy, $1.50/1000 images, fast, ~50MB RAM
ENABLE_TESSERACT=true          # 31% accuracy, free, slow, ~50MB RAM (fallback)

# TIER 2: Standard Plan (2 GB RAM) - Can enable PaddleOCR
ENABLE_PADDLEOCR=false         # 94% accuracy, free, 9s, ~500MB RAM (BEST for production)

# TIER 3: Pro Plan (4+ GB RAM) - Can enable everything
ENABLE_SURYA=false             # 91% accuracy, free, 30s, ~4GB RAM
ENABLE_AWS_TEXTRACT=false      # 85% accuracy, $1.50/1000 pages, ~50MB RAM

# Google Vision API Key (required if ENABLE_GOOGLE_VISION=true)
# Get key: https://console.cloud.google.com/apis/credentials
GOOGLE_VISION_API_KEY=AIzaSyC7AeMY-xrcGzUHGAZp625Z6Qluxbx9YpQ

# AWS Credentials (required if ENABLE_AWS_TEXTRACT=true)
# AWS_ACCESS_KEY_ID=
# AWS_SECRET_ACCESS_KEY=
# AWS_REGION=us-east-1

# Tesseract configuration (for local installs)
TESSERACT_CMD=/usr/bin/tesseract  # Docker/Linux path
# TESSERACT_CMD=/usr/local/bin/tesseract  # macOS Homebrew path
# TESSERACT_CMD=C:\Program Files\Tesseract-OCR\tesseract.exe  # Windows path

# Surya model path (required if ENABLE_SURYA=true)
SURYA_MODEL_PATH=/app/models/surya

# OCR Fallback (auto-retry with next best engine if primary fails)
OCR_FALLBACK_ENABLED=true

# Legacy settings (deprecated - use feature flags above)
# OCR_ENGINE=google_vision  # Deprecated: System auto-selects best enabled engine
# GOOGLE_CLOUD_PROJECT_ID=
# GOOGLE_APPLICATION_CREDENTIALS=

# =============================================================================
# LLM Model Selection
# =============================================================================
LLM_CLASSIFICATION_MODEL=gpt-4.1-nano
LLM_NORMALIZATION_MODEL=gpt-4.1-mini
LLM_ESCALATION_MODEL=gpt-4.1

# =============================================================================
# Cost Control & Budget Limits
# =============================================================================
MAX_LLM_CALLS_PER_SESSION=3
MAX_TOKEN_BUDGET_PER_SESSION=10000
MAX_COST_PER_SESSION=0.50  # USD
MAX_COST_PER_IMAGE=0.30  # USD
LLM_COVERAGE_THRESHOLD=0.8  # Trigger LLM if coverage < 80%

# =============================================================================
# Storage Configuration
# =============================================================================
STORAGE_BUCKET_RECEIVING=pms-receiving-images
STORAGE_BUCKET_DISCREPANCY=pms-discrepancy-photos
STORAGE_BUCKET_LABELS=pms-label-pdfs
STORAGE_BUCKET_PARTS=pms-part-photos
STORAGE_BUCKET_FINANCE=pms-finance-documents

# =============================================================================
# Rate Limiting & Upload Constraints
# =============================================================================
MAX_UPLOADS_PER_HOUR=50
MAX_FILE_SIZE_MB=15
MAX_FILES_PER_UPLOAD=10
UPLOAD_RATE_LIMIT_WINDOW_SECONDS=3600

# Blur Detection
BLUR_THRESHOLD=100.0  # Laplacian variance threshold
MIN_IMAGE_WIDTH=800  # pixels
MIN_IMAGE_HEIGHT=600  # pixels

# =============================================================================
# JWT & Authentication
# =============================================================================
JWT_SECRET=your-jwt-secret-here  # Match your main PMS app
JWT_ALGORITHM=HS256
JWT_AUDIENCE=authenticated

# =============================================================================
# Deployment Configuration
# =============================================================================
RENDER_SERVICE_URL=https://image-processing-xxx.onrender.com
PORT=8001
LOG_LEVEL=info  # Options: debug, info, warning, error
ENVIRONMENT=development  # Options: development, staging, production

# =============================================================================
# Feature Flags
# =============================================================================
ENABLE_CLOUD_OCR_FALLBACK=true
ENABLE_LLM_ESCALATION=true
ENABLE_AUTO_PART_CREATION=false  # Auto-create parts if not found
ENABLE_COST_ALERTS=true  # Alert when approaching cost caps

# =============================================================================
# Monitoring & Observability
# =============================================================================
SENTRY_DSN=  # Optional error tracking
SENTRY_ENVIRONMENT=development
SENTRY_TRACES_SAMPLE_RATE=0.1

# =============================================================================
# Background Jobs (Future)
# =============================================================================
REDIS_URL=redis://localhost:6379  # For job queue (future)
CELERY_BROKER_URL=redis://localhost:6379
CELERY_RESULT_BACKEND=redis://localhost:6379
